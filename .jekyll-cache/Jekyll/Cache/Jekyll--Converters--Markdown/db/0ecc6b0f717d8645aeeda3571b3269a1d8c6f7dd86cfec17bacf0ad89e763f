I"EÑ<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>layout:     pos # Promise
</code></pre></div></div>

<h2 id="exportå¯¼å‡ºå…³é”®å­—">Exportå¯¼å‡ºå…³é”®å­—</h2>

<p>module.exportå¯¼å‡ºä¸€ä¸ªå˜é‡æˆ–å‡½æ•°</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//jså¯¼å‡ºå•ä¸ªå‡½æ•°</span>
<span class="c1">//å¦ä¸€ä¸ªæ–‡ä»¶å¼•ç”¨ä¸ºï¼šconst s = retuire('./script.js');</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">sum</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">a</span><span class="o">+</span><span class="nx">b</span><span class="p">;</span>
<span class="p">};</span>
<span class="c1">//jså¯¼å‡ºå•ä¸ªå˜é‡</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">å°ç™½å¦¹å¦¹</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">//jså¯¼å‡ºå¤šä¸ªå‡½æ•°ï¼Œå¯ä»¥é‡å‘½å</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">SUM</span><span class="p">:</span><span class="nx">sum</span><span class="p">,</span>
  <span class="na">DIV</span><span class="p">:</span><span class="nx">div</span><span class="p">,</span>
  <span class="na">sub</span><span class="p">:</span><span class="nx">sub</span>
<span class="p">};</span>
<span class="c1">//jså¯¼å‡ºä¸€ä¸ªç±»</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">tools</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="promiseåˆä½“éªŒ">promiseåˆä½“éªŒ</h2>

<p>å‚æ•°ä¸ºï¼šä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¯¥æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæˆåŠŸçš„å‚æ•°ï¼ˆresolveï¼‰ï¼Œä¸€ä¸ªå¤±è´¥å‚æ•°ï¼ˆrejectï¼‰ï¼Œè¿™ä¸¤ä¸ªå‚æ•°ç”¨æ¥è¡¨ç¤ºpromiseå¯¹è±¡çš„çŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥å‘è°ƒç”¨çš„åœ°æ–¹ä¼ é€’å‚æ•°,è°ƒç”¨æ–¹å¯ä»¥æœ‰ä¸¤ä¸ªå›åˆ°å‡½æ•°ç¬¬ä¸€ä¸ªä¸ºæˆåŠŸæ—¶çš„å›è°ƒï¼Œç¬¬äºŒä¸ªä¸ºå¤±è´¥çš„å›è°ƒ</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span>  <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="o">&lt;=</span><span class="mi">30</span><span class="p">){</span>
            <span class="nx">reject</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>  
            <span class="nx">resolve</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">æ­å–œæå•Šä¸­å¥–äº†å•Š</span><span class="dl">"</span><span class="o">+</span><span class="nx">value</span><span class="p">);</span>
<span class="p">},</span><span class="nx">reson</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">å¾ˆé—æ†¾å•Šï¼Œæ‚¨æ²¡èƒ½ä¸­å¥–å•Š</span><span class="dl">"</span><span class="o">+</span><span class="nx">reson</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div></div>

<p>promiseå°è£…æ–‡ä»¶æ“ä½œæ¡ˆä¾‹</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">//æ™®é€šæ–¹å¼</span>
<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./read/a.txt</span><span class="dl">'</span><span class="p">,(</span><span class="nx">error</span><span class="p">,</span><span class="nx">value</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">});</span>
<span class="c1">//Pormiseæ–¹å¼</span>
<span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./read/a.txt</span><span class="dl">'</span><span class="p">,(</span><span class="nx">err</span><span class="p">,</span><span class="nx">value</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">})</span>
<span class="c1">//è°ƒç”¨</span>
<span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span> 
<span class="p">},</span><span class="nx">err</span><span class="o">=&gt;</span><span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>å°è£…ä¸€ä¸ªå‡½æ•°mineReadFileè¯»å–æ–‡ä»¶å†…å®¹</p>

<p>å‚æ•°ï¼špathæ–‡ä»¶è·¯å¾„</p>

<p>è¿”å›ï¼špromiseå¯¹è±¡</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span>  <span class="nx">mineReadFile</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">).</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">path</span><span class="p">,(</span><span class="nx">err</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="nx">mineReadFile</span><span class="p">(</span><span class="dl">'</span><span class="s1">./read/a.txt</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span> 
<span class="p">},</span><span class="nx">err</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>åˆ©ç”¨nodejsè‡ªåŠ¨å°è£…ä¸€ä¸ªå‡½æ•°ä¸ºPromise</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">util</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">util</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">fs</span>  <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">p</span>  <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">promisify</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">);</span>

<span class="nx">p</span><span class="p">(</span><span class="dl">'</span><span class="s1">./read/a.txt</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">},</span><span class="nx">err</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="promiseçš„çŠ¶æ€æ”¹å˜">promiseçš„çŠ¶æ€æ”¹å˜</h2>

<p>å®ä¾‹å¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œ[PromiseState]</p>

<ul>
  <li>pending æœªå†³å®šçš„</li>
  <li>resolves/fullfilled æˆåŠŸ</li>
  <li>rejected å¤±è´¥</li>
</ul>

<p>ä¸¤ç§çŠ¶æ€è½¬æ¢</p>

<ol>
  <li>pending å˜ä¸º resolved</li>
  <li>pendingå˜ä¸ºrejected</li>
</ol>

<h2 id="promiseå¯¹è±¡çš„å€¼">Promiseå¯¹è±¡çš„å€¼</h2>

<p>å®ä¾‹å¯¹è±¡çš„å¦ä¸€ä¸ªå±æ€§ã€PromiseStateã€‘</p>

<p>ä¿å­˜ç€å¼‚æ­¥ä»»åŠ¡ã€æˆåŠŸ/å¤±è´¥ã€‘çš„ç»“æœ</p>

<ul>
  <li>resolve(æˆåŠŸå€¼)</li>
  <li>reject(å¤±è´¥å€¼)</li>
</ul>

<h2 id="promiseçš„åŸºæœ¬æµç¨‹">promiseçš„åŸºæœ¬æµç¨‹</h2>

<p><img src="C:\Users\Gaohang\AppData\Roaming\Typora\typora-user-images\image-20211005160216918.png" alt="image-20211005160216918" /></p>

<h2 id="peomiseçš„api">peomiseçš„API</h2>

<ol>
  <li>
    <p>promiseçš„æ„é€ å‡½æ•°ï¼šPromise(extutor);</p>

    <p>(1)  extutorå‡½æ•°ï¼šæ‰§è¡Œå™¨(resolve,reject)=&gt;{}</p>

    <p>(2)  resolveå‡½æ•°ï¼šå†…éƒ¨å®šä¹‰æˆåŠŸæ—¶æˆ‘ä»¬è°ƒç”¨çš„å‡½æ•°valuse=&gt;{}</p>

    <p>(3)  rejectå‡½æ•°ï¼šå†…éƒ¨å®šä¹‰å¤±è´¥æ—¶æˆ‘ä»¬è°ƒç”¨çš„å‡½æ•°reason=&gt;{}</p>

    <p>è¯´æ˜ï¼šextutorä¼šåœ¨Promiseå†…éƒ¨ç«‹å³åŒæ­¥è°ƒç”¨ï¼Œå¼‚æ­¥æ“ä½œåœ¨æ‰§è¡Œå™¨ä¸­æ‰§è¡Œ</p>
  </li>
  <li>
    <p>Promise.prototype.thenæ–¹æ³•ï¼šï¼ˆonResolved,onRejectedï¼‰=&gt;{}</p>

    <p>(1)  onResolvedå‡½æ•°ï¼šæˆåŠŸçš„å›è°ƒå‡½æ•°(value)=&gt;{}</p>

    <p>(2)  onRejectedå‡½æ•°ï¼šå¤±è´¥çš„å›è°ƒå‡½æ•°(reason)=&gt;{}</p>

    <p>è¯´æ˜ï¼šæŒ‡å®šç”¨äºå¾—åˆ°æˆåŠŸvalueçš„æˆåŠŸå›è°ƒå’Œç”¨äºå¾—åˆ°å¤±è´¥reasonçš„å¤±è´¥å›è°ƒè¿”å›ä¸€ä¸ªæ–°çš„promiseå¯¹è±¡</p>
  </li>
  <li>
    <p>Promise.prototype.catchæ–¹æ³•ï¼š(onRejected)=&gt;{}</p>

    <p>(1)  onRejectedå‡½æ•°ï¼šå¤±è´¥çš„å›è°ƒå‡½æ•°(reason)=&gt;{}</p>
  </li>
  <li>
    <p>Promise.resolve()æ–¹æ³•ï¼šè¿”å›ä¸€ä¸ªæˆåŠŸçš„Promiseå¯¹è±¡</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¦‚æœä¼ å…¥çš„å‚æ•°ä¸ºéPromiseç±»å‹çš„å¯¹è±¡ï¼Œåˆ™è¿”å›çš„ç»“æœä¸ºæˆåŠŸPromiseå¯¹è±¡</span>
<span class="c1">//å¦‚æœä¼ å…¥çš„å‚æ•°ä¸ºPromiseå¯¹è±¡ï¼Œåˆ™å‚æ•°çš„ç»“æœå†³å®šäº†resolveçš„ç»“æœ</span>
<span class="kd">let</span> <span class="nx">p1</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="mi">521</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">);</span>
<span class="kd">let</span>  <span class="nx">p2</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">reject</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}));</span>
<span class="nx">p2</span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">reason</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span>
<span class="p">})</span> 
</code></pre></div>    </div>
  </li>
  <li>
    <p>Promise.rejectæ–¹æ³•ï¼šï¼ˆreasonï¼‰=&gt;{}</p>

    <p>(1)  reasonï¼šå¤±è´¥çš„åŸå› </p>

    <p>è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªå¤±è´¥çš„Promiseå¯¹è±¡</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">p1</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="mi">521</span><span class="p">);</span>
<span class="nx">p1</span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">reason</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span>
<span class="p">});</span>
<span class="kd">let</span> <span class="nx">p2</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p2</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Promise.allæ–¹æ³•ï¼š(promises)=&gt;{}</p>

    <p>(1)  promise åŒ…å«Nä¸ªpromiseæ•°ç»„</p>

    <p>è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªæ–°çš„promiseï¼Œåªæœ‰æ‰€æœ‰çš„promiseéƒ½æˆåŠŸæ‰æˆåŠŸï¼Œåªè¦æœ‰ä¸€ä¸ªå¤±è´¥äº†å°±ç›´æ¥å¤±è´¥</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>
<span class="kd">let</span> <span class="nx">p2</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">p3</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">sucess</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">p4</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span><span class="nx">p1</span><span class="p">,</span><span class="nx">p2</span><span class="p">,</span><span class="nx">p3</span><span class="p">]);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p4</span><span class="p">);</span>   
</code></pre></div>    </div>
  </li>
  <li>
    <p>Promise.raceæ–¹æ³•ï¼š(promises)=&gt;{}</p>

    <p>(1) promise ï¼šåŒ…å«nä¸ªpromise çš„æ•°ç»„</p>

    <p>è¯´æ˜ï¼šè¿”å›ä¸€ä¸ªæ–°çš„promiseï¼Œç¬¬ä¸€ä¸ªå®Œæˆçš„promiseçš„ç»“æœçŠ¶æ€å°±æ˜¯æœ€ç»ˆçš„ç»“æœçŠ¶æ€</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>
<span class="kd">let</span> <span class="nx">p2</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">p3</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">sucess</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">p4</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span><span class="nx">p1</span><span class="p">,</span><span class="nx">p2</span><span class="p">,</span><span class="nx">p3</span><span class="p">]);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p4</span><span class="p">);</span>   
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="promiseå…³é”®é—®é¢˜">Promiseå…³é”®é—®é¢˜</h2>

<h3 id="--promiseå¯¹è±¡çŠ¶æ€æ”¹å˜æ–¹å¼">- promiseå¯¹è±¡çŠ¶æ€æ”¹å˜æ–¹å¼</h3>

<ul>
  <li>
    <p>é€šè¿‡resolveå’Œrejectæˆ–thorw</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span>  <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="c1">//resolve("æˆåŠŸï¼");  //ç”±pending -&gt; fulfilled(resolved)</span>
    <span class="c1">//reject("å¤±è´¥"); //ç”±pendging -&gt; rejected</span>
    <span class="k">throw</span> <span class="dl">"</span><span class="s2">å‡ºé”™äº†</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//ç”±pending -&gt; rejected</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="--ä¸€ä¸ªpromiseæŒ‡å®šå¤šä¸ªæˆåŠŸå¤±è´¥å›è°ƒå‡½æ•°éƒ½ä¼šè°ƒç”¨å—">- ä¸€ä¸ªpromiseæŒ‡å®šå¤šä¸ªæˆåŠŸ/å¤±è´¥å›è°ƒå‡½æ•°ï¼Œéƒ½ä¼šè°ƒç”¨å—ï¼Ÿ</h3>

<p>å½“promiseæ”¹å˜ä¸ºå¯¹åº”çŠ¶æ€æ—¶éƒ½ä¼šè°ƒç”¨</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span>  <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="dl">"</span><span class="s2">æˆåŠŸ</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">alert</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">})</span>
</code></pre></div></div>

<h3 id="æ”¹å˜promiseçŠ¶æ€å’ŒæŒ‡å®šå›åˆ°å‡½æ•°è°å…ˆè°å">æ”¹å˜promiseçŠ¶æ€å’ŒæŒ‡å®šå›åˆ°å‡½æ•°è°å…ˆè°å</h3>

<p>éƒ½æœ‰å¯èƒ½</p>

<p>å½“promiseä¸­çš„ä»»åŠ¡ä¸ºåŒæ­¥ä»»åŠ¡æ—¶ï¼Œresolveå…ˆæ‰§è¡Œï¼Œthenåæ‰§è¡Œ</p>

<p>å½“peomiseä¸­çš„ä»»åŠ¡ä¸ºå¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œthenå…ˆæ‰§è¡Œï¼Œresolveåæ‰§è¡Œ</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">setTimeout</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="dl">"</span><span class="s2">ok</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">},</span><span class="mi">1000</span><span class="p">)</span>
        <span class="p">});</span>
        <span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">},</span><span class="nx">err</span><span class="o">=&gt;</span><span class="p">{</span>

        <span class="p">});</span>
</code></pre></div></div>

<h3 id="thenæ–¹æ³•è¿”å›çš„ç»“æœç”±ä»€ä¹ˆå†³å®š">thenæ–¹æ³•è¿”å›çš„ç»“æœç”±ä»€ä¹ˆå†³å®š</h3>

<p>ç”±thenæ–¹æ³•ä¸­çš„å›è°ƒå‡½æ•°è¿”å›ç»“æœï¼ˆreturnï¼‰å†³å®š</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">resolve</span><span class="p">(</span><span class="dl">"</span><span class="s2">ok</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="kd">let</span> <span class="nx">p1</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="dl">"</span><span class="s2">sucess</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">},</span><span class="nx">err</span><span class="o">=&gt;</span><span class="p">{</span>

        <span class="p">});</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p1</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="promiseå®ç°ä»»åŠ¡ä¸²è”">promiseå®ç°ä»»åŠ¡ä¸²è”</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">setTimeout</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span>
             <span class="nx">resolve</span><span class="p">(</span><span class="dl">"</span><span class="s2">ok</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">},</span><span class="mi">1000</span><span class="p">);</span>
         <span class="p">});</span>
         <span class="kd">let</span> <span class="nx">p1</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
             <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                 <span class="nx">resolve</span><span class="p">(</span><span class="dl">"</span><span class="s2">sucess</span><span class="dl">"</span><span class="p">);</span>
             <span class="p">});</span>
         <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
             <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
             <span class="k">return</span> <span class="dl">"</span><span class="s2">okok</span><span class="dl">"</span><span class="p">;</span>
         <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
             <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
         <span class="p">});</span>
</code></pre></div></div>

<h2 id="asyncå‡½æ•°">asyncå‡½æ•°</h2>

<p>saynsè¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªpromiseå¯¹è±¡</p>

<ul>
  <li>
    <p>å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªépromiseç±»å‹çš„æ•°æ®ï¼ŒçŠ¶æ€ä¸ºæˆåŠŸçš„promiseå¯¹è±¡</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
            <span class="c1">//1.å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªépromiseç±»å‹çš„æ•°æ®ï¼ŒçŠ¶æ€ä¸ºæˆåŠŸçš„promiseå¯¹è±¡</span>
            <span class="k">return</span> <span class="dl">'</span><span class="s1">521</span><span class="dl">'</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">main</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªpromiseç±»å‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆçŠ¶æ€ç”±resolveã€rejectã€throwå†³å®š</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
            <span class="c1">//1.å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªépromiseç±»å‹çš„æ•°æ®ï¼ŒçŠ¶æ€ä¸ºæˆåŠŸçš„promiseå¯¹è±¡</span>
            <span class="c1">// return '521';</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="c1">// resolve("ok");</span>
                <span class="c1">// reject("err");</span>
                <span class="k">throw</span> <span class="dl">'</span><span class="s1">å‡ºé”™äº†</span><span class="dl">'</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">main</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="awaitè¡¨è¾¾å¼">awaitè¡¨è¾¾å¼</h2>

<ol>
  <li>awaitå³ä¾§ä¸€èˆ¬ä¸ºpromiseå¯¹è±¡ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„å€¼</li>
  <li>å¦‚æœè¡¨è¾¾å¼æ˜¯promiseå¯¹è±¡ï¼Œawaitè¿”å›çš„æ˜¯promiseæˆåŠŸçš„å€¼</li>
  <li>å¦‚æœè¡¨è¾¾å¼æ˜¯å…¶ä»–å€¼ï¼Œç›´æ¥å°†æ­¤å€¼ä½œä¸ºawaitçš„è¿”å›å€¼</li>
</ol>

<p>æ³¨ï¼šawaitå¿…é¡»å†™åœ¨asyncå‡½æ•°ä¸­ï¼Œä½†asyncå‡½æ•°ä¸­å¯ä»¥æ²¡æœ‰await</p>

<p>å¦‚æœawaitçš„promiseå¤±è´¥äº†ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦tryâ€¦catchæ•è·å¤„ç†</p>

<ul>
  <li>
    <p>awaitå³ä¾§ä¸ºpromiseå¯¹è±¡</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
            <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">ok</span><span class="dl">'</span><span class="p">);</span> 
            <span class="p">});</span>
            <span class="c1">//1.å³ä¾§ä¸ºpromiseçš„æƒ…å†µ</span>
            <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span>  <span class="nx">p</span><span class="p">;</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">main</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>awaitå³ä¾§ä¸ºå…¶ä»–ç±»å‹çš„æ•°æ®</p>

    <pre><code class="language-javasc">async function main(){
            let p = new Promise((resolve,reject)=&gt;{
                resolve('ok'); 
            });
            //1.å³ä¾§ä¸ºpromiseçš„æƒ…å†µ
            // let res = await  p;
            // console.log(res);
            //2.å³ä¾§ä¸ºå…¶ä»–ç±»å‹çš„æ•°æ®
            let res2 = await 20;
            console.log(res2);
        }
        main();
</code></pre>
  </li>
  <li>
    <p>å¦‚æœpromiseæ˜¯å¤±è´¥çš„çŠ¶æ€,å¯ä»¥é€šè¿‡tryâ€¦.catchæ¥æ•è·</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
            <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="nx">reject</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="c1">// resolve('ok'); </span>
                <span class="nx">reject</span><span class="p">(</span><span class="dl">"</span><span class="s2">err</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">});</span>
            <span class="c1">//1.å³ä¾§ä¸ºpromiseçš„æƒ…å†µ</span>
            <span class="c1">// let res = await  p;</span>
            <span class="c1">// console.log(res);</span>
            <span class="c1">//2.å³ä¾§ä¸ºå…¶ä»–ç±»å‹çš„æ•°æ®</span>
            <span class="k">try</span> <span class="p">{</span>
  
             <span class="kd">let</span> <span class="nx">res2</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">p</span><span class="p">;</span>
                  
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">main</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="asyncå’Œawaitç»“åˆ">asyncå’Œawaitç»“åˆ</h2>

<h1 id="axios">axios</h1>

<h2 id="axiosçš„ç†è§£å’Œä½¿ç”¨">axiosçš„ç†è§£å’Œä½¿ç”¨</h2>

<ul>
  <li>
    <p>axioså‘é€ajaxè¯·æ±‚</p>

    <p>è°ƒç”¨axioså‡½æ•°ï¼Œå°†å‚æ•°æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚</p>

    <p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¯·æ±‚ç±»å‹</p>

    <p>ç¬¬äºŒä¸ªå‚æ•°ï¼šè¯·æ±‚è·¯å¾„</p>

    <p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šè¯·æ±‚å‚æ•°</p>

    <p>å“åº”ä¸ºä¸€ä¸ªpromiseå¯¹è±¡</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">//è·å–æŒ‰é’®</span>
        <span class="kd">const</span> <span class="nx">btns</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">button</span><span class="dl">'</span><span class="p">);</span>
  
        <span class="c1">//ç¬¬ä¸€ä¸ª,å‘é€getè¯·æ±‚</span>
        <span class="nx">btns</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="c1">//å‘é€AJAXè¯·æ±‚</span>
            <span class="nx">axios</span><span class="p">({</span>
                <span class="c1">//è¯·æ±‚ç±»å‹</span>
                <span class="na">method</span><span class="p">:</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span>
                <span class="c1">//URL</span>
                <span class="na">url</span><span class="p">:</span><span class="dl">'</span><span class="s1">http://localhost:3000/posts/2</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">respose</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">respose</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="c1">//ç¬¬äºŒå‘é€POSTè¯·æ±‚,æ·»åŠ æ•°æ®</span>
        <span class="nx">btns</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="c1">//å‘é€AJAXè¯·æ±‚</span>
            <span class="nx">axios</span><span class="p">({</span>
                <span class="c1">//è¯·æ±‚ç±»å‹</span>
                <span class="na">method</span><span class="p">:</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
                <span class="c1">//URL</span>
                <span class="na">url</span><span class="p">:</span><span class="dl">'</span><span class="s1">http://localhost:3000/posts</span><span class="dl">'</span><span class="p">,</span> 
                <span class="c1">//è®¾ç½®è¯·æ±‚ä½“</span>
                <span class="na">data</span><span class="p">:{</span>
                    <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">ä»Š</span><span class="dl">"</span><span class="p">,</span>
                    <span class="dl">"</span><span class="s2">author</span><span class="dl">"</span><span class="p">:</span><span class="dl">'</span><span class="s1">å¼ ä¸‰</span><span class="dl">'</span>
                <span class="p">}</span>
            <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">respose</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">respose</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="c1">//ç¬¬ä¸‰ä¸ªï¼Œæ›´æ–°æ•°æ®</span>
        <span class="nx">btns</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">axios</span><span class="p">({</span>
                <span class="na">method</span><span class="p">:</span><span class="dl">'</span><span class="s1">PUT</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">url</span><span class="p">:</span><span class="dl">'</span><span class="s1">http://localhost:3000/posts/3</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">data</span><span class="p">:{</span>
                    <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span><span class="dl">'</span><span class="s1">ä»Šå¤©å¤©æ°”ä¸å¥½</span><span class="dl">'</span><span class="p">,</span>
                    <span class="dl">'</span><span class="s1">author</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">æå››</span><span class="dl">'</span>
                <span class="p">}</span>
            <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">respose</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">respose</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">}</span>
        <span class="c1">//åˆ é™¤æ•°æ®</span>
        <span class="nx">btns</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">axios</span><span class="p">({</span>
                <span class="na">method</span><span class="p">:</span><span class="dl">'</span><span class="s1">delete</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">url</span><span class="p">:</span><span class="dl">'</span><span class="s1">http://localhost:3000/posts/4</span><span class="dl">'</span>
            <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">respose</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">respose</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>axiosä¸­çš„æ–¹æ³•</p>

    <ul>
      <li>
        <p>axios.request()ï¼šå’Œajaxè¯·æ±‚å·®ä¸å¤š</p>

        <p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¯·æ±‚æ–¹å¼</p>

        <p>ç¬¬äºŒä¸ªå‚æ•°ï¼šè¯·æ±‚è·¯å¾„</p>

        <p>è¿”å›çš„æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œç”¨thenæ–¹æ³•æ¥æ”¶åï¼Œresponseæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªdataå¯¹è±¡æ•°ç»„ï¼Œæ•°ç»„ä¸­å­˜æ”¾äº†è¿”å›çš„æ•°æ®</p>

        <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
    <span class="nx">axios</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
    <span class="na">method</span><span class="p">:</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span><span class="dl">'</span><span class="s1">http://localhost/3000/comments</span><span class="dl">'</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">})</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>axios.postï¼šå‘é€postè¯·æ±‚</p>

        <p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¯·æ±‚è·¯å¾„</p>

        <p>ç¬¬äºŒä¸ªå‚æ•°ï¼šè¯·æ±‚ä½“ä¸ºjsonå¯¹è±¡æ ¼å¼</p>

        <p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šé…ç½®</p>

        <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://localhost:3000/comments</span><span class="dl">'</span><span class="p">,{</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">æˆ‘æ˜¯ä¸€ä¸ªå¥½äºº</span><span class="dl">'</span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="o">=&gt;</span><span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">)});</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="responseå¯¹è±¡">responseå¯¹è±¡</h3>

<p>ç¬¬ä¸€ä¸ªconfigï¼šé…ç½®å¯¹è±¡ï¼ŒåŒ…æ‹¬è¯·æ±‚ç±»å‹ï¼Œurlï¼Œè¯·æ±‚ä½“â€¦.</p>

<p>ç¬¬äºŒä¸ªdataï¼šå“åº”ä½“çš„ç»“æœï¼Œæ˜¯ä¸€ä¸ªjsonå¯¹è±¡æ•°ç»„</p>

<p>ç¬¬ä¸‰ä¸ªheadersï¼šå“åº”å¤´ä¿¡æ¯ï¼Œ</p>

<p>ç¬¬å››ä¸ªrequestï¼šåŸç”Ÿajaxè¯·æ±‚å¯¹è±¡ï¼Œstatusï¼šçŠ¶æ€ç ï¼ŒstatusTextï¼šâ€œokâ€</p>

<h3 id="axiosä¸­é…ç½®å¯¹è±¡">axiosä¸­é…ç½®å¯¹è±¡</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>

<span class="c1">//urlå‚æ•°</span>
<span class="nl">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/user</span><span class="dl">'</span><span class="p">,</span>
<span class="c1">//è¯·æ±‚æ–¹å¼</span>
<span class="nx">method</span><span class="p">:</span><span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
<span class="c1">//baseURLï¼šè®¾å®šurlçš„åŸºç¡€ç»“æ„,ä¾‹å¦‚http://,è¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½å†™äº†</span>
<span class="nx">baseURL</span><span class="p">:</span><span class="dl">'</span><span class="s1">https://some-domin.com/api</span><span class="dl">'</span><span class="p">,</span>
<span class="c1">//å¯¹è¯·æ±‚çš„æ•°æ®åšå¤„ç†ï¼Œå°†å¤„ç†åçš„ç»“æœå‘æœåŠ¡å™¨å‘é€</span>
<span class="nx">transformRequest</span><span class="p">:[</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">headers</span><span class="p">){</span>
	<span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
<span class="p">}],</span>
<span class="c1">//å¯¹å“åº”çš„æ•°æ®è¿›è¡Œå¤„ç†</span>
<span class="nx">transformResponse</span><span class="p">:[</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">data</span>
<span class="p">}],</span>
<span class="c1">//å¯¹è¯·æ±‚å¤´ä¿¡æ¯åšé…ç½®,åœ¨ä¸€äº›è¯·æ±‚ä¸­æœ‰å¯èƒ½è¦æ±‚ç‰¹å®šçš„è¯·æ±‚å¤´ä¿¡æ¯ </span>
<span class="nx">headers</span><span class="p">:{</span><span class="dl">'</span><span class="s1">X-Requestd-With</span><span class="dl">'</span><span class="p">},</span>
<span class="c1">//è®¾å®šurlå‚æ•°</span>
<span class="nx">params</span><span class="p">{</span>
    <span class="nl">ID</span><span class="p">:</span><span class="mi">12345</span>
<span class="p">},</span>
<span class="c1">//è¯·æ±‚å‚æ•°åºåˆ—åŒ–</span>
<span class="nx">paramsSerializer</span><span class="p">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">params</span><span class="p">){</span>
    
<span class="p">}</span><span class="err">ï¼Œ</span>
<span class="nx">data</span><span class="p">:</span><span class="nx">å¦‚æœæ˜¯å¯¹è±¡axiosä¼šè½¬å˜ä¸ºjson</span><span class="err">ï¼Œ</span><span class="nx">å¦‚æœæ˜¯å­—ç¬¦ä¸²é‚£ä¹ˆç›´æ¥ä¼ é€’</span><span class="p">,</span>
<span class="c1">//ç”¨æˆ·åå¯†ç </span>
<span class="nx">auth</span><span class="p">:{</span>
    <span class="nl">username</span><span class="p">:</span><span class="dl">''</span><span class="p">,</span>
    <span class="nx">password</span><span class="p">:</span><span class="dl">''</span>
<span class="p">},</span>
<span class="c1">//</span>
<span class="p">}</span>
</code></pre></div></div>

<p>é…ç½®æ–‡ä»¶,çœç•¥å‚æ•°</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ä¸ºç»™å®š ID çš„ user åˆ›å»ºè¯·æ±‚</span>
<span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/user?ID=12345</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>

<span class="c1">// ä¸Šé¢çš„è¯·æ±‚ä¹Ÿå¯ä»¥è¿™æ ·åš</span>
<span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/user</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">ID</span><span class="p">:</span> <span class="mi">12345</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div></div>

<h3 id="axioxä¸­é»˜è®¤é…ç½®">axioxä¸­é»˜è®¤é…ç½®</h3>

<ul>
  <li>axios.defaults.method = â€˜GETâ€™ //è®¾ç½®é»˜è®¤çš„è¯·æ±‚ç±»å‹ä¸ºget</li>
  <li>axios.defaults.baseURL = â€˜http://localhost:3000â€™ //è®¾ç½®åŸºç¡€urlï¼Œåœ¨åç»­ä½¿ç”¨ä¸­ä¸ç”¨å†™</li>
  <li>axios.defaults.params = {id:100}; //é»˜è®¤å‚æ•°</li>
  <li>axios.defaults.timeout = 3000; //3ç§’ä¹‹åæ²¡æœ‰ç›¸åº”ï¼Œå–æ¶ˆè¿™ä¸ªè¯·æ±‚</li>
  <li>axios.defaults.headers.post[â€˜Content-Typeâ€™] = â€˜application/x-www-form-urlencodedâ€™;  //é…ç½®å…¬å…±çš„ post çš„ Content-Type</li>
  <li>axios.defaults.headers.common[â€˜Authorizationâ€™] = AUTH_TOKEN; //åœ¨è¯·æ±‚å¤´é…ç½®å…¬å…±çš„authorizationé…ç½®é»˜è®¤çš„token</li>
</ul>
:ET